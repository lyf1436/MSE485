LAMMPS (23 Jun 2022 - Update 1)
# Compute elastic constant tensor for a crystal
#
# Written by Aidan Thompson (Sandia, athomps@sandia.gov)
#
#  This script uses the following three include files.
#
#   init.mod      (must be modified for different crystal structures)
# 	       	  Define units, deformation parameters and initial
#		  configuration of the atoms and simulation cell.
#
#
#   potential.mod    (must be modified for different pair styles)
# 		     Define pair style and other attributes
#		     not stored in restart file
#
#
#   displace.mod    (displace.mod should not need to be modified)
# 		    Perform positive and negative box displacements
# 		    in direction ${dir} and size ${up}.
# 		    It uses the resultant changes
#		    in stress to compute one
# 		    row of the elastic stiffness tensor
#
#		    Inputs variables:
#		    	   dir = the Voigt deformation component
#		    		    (1,2,3,4,5,6)
#		    Global constants:
#       	    	   up = the deformation magnitude (strain units)
#       		   cfac = conversion from LAMMPS pressure units to
#               	   output units for elastic constants
#
#
#  To run this on a different system, it should only be necessary to
#  modify the files init.mod and potential.mod. In order to calculate
#  the elastic constants correctly, care must be taken to specify
#  the correct units in init.mod (units, cfac and cunits). It is also
#  important to verify that the minimization of energy w.r.t atom
#  positions in the deformed cell is fully converged.
#  One indication of this is that the elastic constants are insensitive
#  to the choice of the variable ${up} in init.mod. Another is to check
#  the final max and two-norm forces reported in the log file. If you know
#  that minimization is not required, you can set maxiter = 0.0 in
#  init.mod.
#

include init.mod
# NOTE: This script can be modified for different atomic structures,
# units, etc. See in.elastic for more info.
#

# Define the finite deformation size. Try several values of this
# variable to verify that results do not depend on it.
variable up equal 1.0e-6

# Define the amount of random jiggle for atoms
# This prevents atoms from staying on saddle points
variable atomjiggle equal 1.0e-5

# metal units, elastic constants in GPa
units		metal
variable cfac equal 1.0e-4
variable cunits string GPa

# Define minimization parameters
variable etol equal 0.0
variable ftol equal 1.0e-10
variable maxiter equal 500
variable maxeval equal 1000
variable dmax equal 1.0e-2

# generate the box and atom positions using a diamond lattice
# variable a equal 5.43

boundary	p p p

lattice     fcc 4.608
Lattice spacing in x,y,z = 4.608 4.608 4.608
region		simbox prism -1.0 1.0 -1.0 1.0 -1.0 1.0 0.0 0.0 0.0
create_box	2 simbox
Created triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
lattice 	fcc 4.608 orient x 1 0 0 orient y 0 1 0 orient z 0 0 1
Lattice spacing in x,y,z = 4.608 4.608 4.608
create_atoms	1 region simbox
Created 32 atoms
  using lattice units in triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 0 0)
  create_atoms CPU = 0.000 seconds
lattice 	fcc 4.608 origin 0 0 0.5 orient x 1 0 0 orient y 0 1 0 orient z 0 0 1
Lattice spacing in x,y,z = 4.608 4.608 4.608
create_atoms	2 region simbox
Created 32 atoms
  using lattice units in triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 0 0)
  create_atoms CPU = 0.000 seconds
dump DUMPFILE all xyz 1 dump.xyz

# Need to set mass to something, just to satisfy LAMMPS
mass 1 91.224
mass 2 14.007

include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style	meam
pair_coeff * * library_ZrN.meam Zr N ZrN.meam Zr N
Reading MEAM library file library_ZrN.meam with DATE: 2015-02-12

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Compute initial state
fix 3 all box/relax  aniso 0.0
minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 500 ${maxeval}
minimize 0 1e-10 500 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.26
  ghost atom cutoff = 6.26
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.94 | 10.94 | 10.94 Mbytes
   Step          Temp          PotEng         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
         0   0             -472.768        0.029718359    0.029718359    0.029718359    0.029718359    3.9995014e-11  1.8179552e-11  3.6359104e-11  9.216          9.216          9.216          782.75779    
         1   0             -472.768       -1.9241453e-06 -1.9241238e-06 -1.9241492e-06 -1.9241628e-06 -7.2682434e-12 -1.2729263e-11  1.2725686e-11  9.216          9.216          9.216          782.7578     
         2   0             -472.768       -5.7992769e-10 -5.6356608e-10 -5.7810974e-10 -5.9810725e-10 -1.6354873e-11  7.2650974e-12 -3.6359103e-12  9.216          9.216          9.216          782.7578     
Loop time of 0.0052023 on 1 procs for 2 steps with 64 atoms

98.9% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
     -472.768000013946  -472.768000013944  -472.768000013949
  Force two-norm initial, final = 2.5147944e-05 5.3302223e-13
  Force max component initial, final = 1.4519172e-05 2.922107e-13
  Final line search alpha, max atom move = 1 2.922107e-13
  Iterations, force evaluations = 2 4

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0049932  | 0.0049932  | 0.0049932  |   0.0 | 95.98
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 1.3767e-05 | 1.3767e-05 | 1.3767e-05 |   0.0 |  0.26
Output  | 5.7275e-05 | 5.7275e-05 | 5.7275e-05 |   0.0 |  1.10
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0001381  |            |       |  2.65

Nlocal:             64 ave          64 max          64 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:            665 ave         665 max         665 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           2560 ave        2560 max        2560 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:         5120 ave        5120 max        5120 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5120
Ave neighs/atom = 80
Neighbor list builds = 0
Dangerous builds = 0

variable tmp equal pxx
variable pxx0 equal ${tmp}
variable pxx0 equal -5.63566077113109e-10
variable tmp equal pyy
variable pyy0 equal ${tmp}
variable pyy0 equal -5.78109744699513e-10
variable tmp equal pzz
variable pzz0 equal ${tmp}
variable pzz0 equal -5.98107251591635e-10
variable tmp equal pyz
variable pyz0 equal ${tmp}
variable pyz0 equal -3.6359103440221e-12
variable tmp equal pxz
variable pxz0 equal ${tmp}
variable pxz0 equal 7.26509741181912e-12
variable tmp equal pxy
variable pxy0 equal ${tmp}
variable pxy0 equal -1.63548732718744e-11

variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 9.2160000424006
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 9.2160000424006
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 9.2160000424006

# These formulas define the derivatives w.r.t. strain components
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1--5.63566077113109e-10)/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1--5.63566077113109e-10)/(v_delta/v_len0)*0.0001
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1--5.78109744699513e-10)/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1--5.78109744699513e-10)/(v_delta/v_len0)*0.0001
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1--5.98107251591635e-10)/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1--5.98107251591635e-10)/(v_delta/v_len0)*0.0001
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1--3.6359103440221e-12)/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1--3.6359103440221e-12)/(v_delta/v_len0)*0.0001
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1-7.26509741181912e-12)/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1-7.26509741181912e-12)/(v_delta/v_len0)*0.0001
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1--1.63548732718744e-11)/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1--1.63548732718744e-11)/(v_delta/v_len0)*0.0001

displace_atoms all random ${atomjiggle} ${atomjiggle} ${atomjiggle} 87287 units box
displace_atoms all random 1e-05 ${atomjiggle} ${atomjiggle} 87287 units box
displace_atoms all random 1e-05 1e-05 ${atomjiggle} 87287 units box
displace_atoms all random 1e-05 1e-05 1e-05 87287 units box
Displacing atoms ...

# Write restart
unfix 3
write_restart restart.equil
System init for write_restart ...

# uxx Perturbation

variable dir equal 1
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 9.2160000424006
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
Reading restart file ...
  restart file = 23 Jun 2022, LAMMPS = 23 Jun 2022
  restoring atom style atomic from restart
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  pair style meam stores no restart info
  64 atoms
  read_restart CPU = 0.000 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style	meam
pair_coeff * * library_ZrN.meam Zr N ZrN.meam Zr N
Reading MEAM library file library_ZrN.meam with DATE: 2015-02-12

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1e-06*${len0}
variable delta equal -1e-06*9.2160000424006
variable deltaxy equal -${up}*xy
variable deltaxy equal -1e-06*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -1e-06*xz
variable deltayz equal -${up}*yz
variable deltayz equal -1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -9.2160000424006e-06 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -9.2160000424006e-06 xy delta -0 xz delta ${deltaxz} remap units box
change_box all x delta 0 -9.2160000424006e-06 xy delta -0 xz delta -0 remap units box
Changing box ...
  triclinic box = (-4.608 -4.608 -4.608) to (4.6079908 4.608 4.608) with tilt (0 0 0)
  triclinic box = (-4.608 -4.608 -4.608) to (4.6079908 4.608 4.608) with tilt (0 0 0)
  triclinic box = (-4.608 -4.608 -4.608) to (4.6079908 4.608 4.608) with tilt (0 0 0)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 500 ${maxeval}
minimize 0 1e-10 500 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.26
  ghost atom cutoff = 6.26
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 9.913 | 9.913 | 9.913 Mbytes
   Step          Temp          PotEng         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
         2   0             -472.768        2.153295       4.8071121      0.82638617     0.82638682     2.5055605e-06  5.2883187e-07  4.2276199e-06  9.2159908      9.216          9.216          782.75702    
         3   0             -472.768        2.153169       4.8069643      0.82626769     0.82627485     1.1746498e-06 -8.402637e-07  -8.4798149e-08  9.2159908      9.216          9.216          782.75702    
         4   0             -472.768        2.1531581      4.8069562      0.82625898     0.82625922     2.5221199e-07 -5.2463273e-07 -4.9053933e-08  9.2159908      9.216          9.216          782.75702    
         5   0             -472.768        2.1531574      4.8069554      0.82625837     0.82625856     1.5809283e-07  1.4747381e-08 -6.1351504e-09  9.2159908      9.216          9.216          782.75702    
         6   0             -472.768        2.1531573      4.8069554      0.82625835     0.82625833     2.2112379e-08  3.4757292e-08 -1.1761727e-08  9.2159908      9.216          9.216          782.75702    
         7   0             -472.768        2.1531572      4.8069552      0.82625826     0.82625824     6.1401497e-10  1.4379358e-08  1.1244064e-09  9.2159908      9.216          9.216          782.75702    
         8   0             -472.768        2.1531572      4.8069552      0.82625824     0.82625823     9.0897849e-10  4.1726658e-09  9.2397664e-10  9.2159908      9.216          9.216          782.75702    
         9   0             -472.768        2.1531572      4.8069552      0.82625823     0.82625823     7.8115339e-10 -2.0838332e-10  4.2721989e-11  9.2159908      9.216          9.216          782.75702    
        10   0             -472.768        2.1531572      4.8069552      0.82625823     0.82625823     1.7043347e-10 -1.1566751e-10  1.5452634e-11  9.2159908      9.216          9.216          782.75702    
        11   0             -472.768        2.1531572      4.8069552      0.82625823     0.82625823     9.4306519e-12 -2.2724462e-12  2.3178952e-11  9.2159908      9.216          9.216          782.75702    
        12   0             -472.768        2.1531572      4.8069552      0.82625823     0.82625823    -1.5793501e-11 -4.7721371e-12  6.9536855e-11  9.2159908      9.216          9.216          782.75702    
        13   0             -472.768        2.1531572      4.8069552      0.82625823     0.82625823     8.1808065e-12 -3.192787e-11  -2.8178333e-11  9.2159908      9.216          9.216          782.75702    
        14   0             -472.768        2.1531572      4.8069552      0.82625823     0.82625823     7.0445833e-12  8.9761626e-12  6.8173387e-12  9.2159908      9.216          9.216          782.75702    
        15   0             -472.768        2.1531572      4.8069552      0.82625823     0.82625823     4.5448925e-13  5.6129422e-11 -6.4991962e-11  9.2159908      9.216          9.216          782.75702    
        16   0             -472.768        2.1531572      4.8069552      0.82625823     0.82625823    -1.4089167e-11 -2.1360995e-11 -4.4085457e-11  9.2159908      9.216          9.216          782.75702    
        17   0             -472.768        2.1531572      4.8069552      0.82625823     0.82625823    -1.4316411e-11  1.4884523e-11 -1.5907124e-11  9.2159908      9.216          9.216          782.75702    
        18   0             -472.768        2.1531572      4.8069552      0.82625823     0.82625823    -3.9540565e-11 -1.9202171e-11  1.9543038e-11  9.2159908      9.216          9.216          782.75702    
        19   0             -472.768        2.1531572      4.8069552      0.82625823     0.82625823     1.0226008e-11 -3.635914e-11  -5.0902796e-11  9.2159908      9.216          9.216          782.75702    
Loop time of 0.0385293 on 1 procs for 17 steps with 64 atoms

99.5% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -472.767999975   -472.76800001277   -472.76800001277
  Force two-norm initial, final = 0.0010872395 1.0981292e-11
  Force max component initial, final = 0.00024560966 1.905257e-12
  Final line search alpha, max atom move = 1 1.905257e-12
  Iterations, force evaluations = 17 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.038162   | 0.038162   | 0.038162   |   0.0 | 99.05
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 8.4539e-05 | 8.4539e-05 | 8.4539e-05 |   0.0 |  0.22
Output  | 0.00018961 | 0.00018961 | 0.00018961 |   0.0 |  0.49
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 9.33e-05   |            |       |  0.24

Nlocal:             64 ave          64 max          64 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:            665 ave         665 max         665 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           2560 ave        2560 max        2560 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:         5120 ave        5120 max        5120 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5120
Ave neighs/atom = 80
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 4.80695522167003
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 0.826258229712605
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 0.826258229572395
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 1.02260080685702e-11
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -3.63591397993608e-11
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -5.09027957191051e-11

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 480.69552222336
variable C2neg equal ${d2}
variable C2neg equal 82.6258230290715
variable C3neg equal ${d3}
variable C3neg equal 82.6258230170502
variable C4neg equal ${d4}
variable C4neg equal -4.7266885375083e-09
variable C5neg equal ${d5}
variable C5neg equal -4.36242372111799e-09
variable C6neg equal ${d6}
variable C6neg equal 2.65808813404446e-09

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
Reading restart file ...
  restart file = 23 Jun 2022, LAMMPS = 23 Jun 2022
  restoring atom style atomic from restart
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  pair style meam stores no restart info
  64 atoms
  read_restart CPU = 0.000 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style	meam
pair_coeff * * library_ZrN.meam Zr N ZrN.meam Zr N
Reading MEAM library file library_ZrN.meam with DATE: 2015-02-12

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1e-06*${len0}
variable delta equal 1e-06*9.2160000424006
variable deltaxy equal ${up}*xy
variable deltaxy equal 1e-06*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1e-06*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 9.2160000424006e-06 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 9.2160000424006e-06 xy delta 0 xz delta ${deltaxz} remap units box
change_box all x delta 0 9.2160000424006e-06 xy delta 0 xz delta 0 remap units box
Changing box ...
  triclinic box = (-4.608 -4.608 -4.608) to (4.6080092 4.608 4.608) with tilt (0 0 0)
  triclinic box = (-4.608 -4.608 -4.608) to (4.6080092 4.608 4.608) with tilt (0 0 0)
  triclinic box = (-4.608 -4.608 -4.608) to (4.6080092 4.608 4.608) with tilt (0 0 0)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 500 ${maxeval}
minimize 0 1e-10 500 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.26
  ghost atom cutoff = 6.26
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 9.913 | 9.913 | 9.913 Mbytes
   Step          Temp          PotEng         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
         2   0             -472.768       -2.1530025     -4.8067561     -0.82612599    -0.82612534     2.5055064e-06  5.289091e-07   4.2276492e-06  9.2160093      9.216          9.216          782.75858    
         3   0             -472.768       -2.1531285     -4.8069039     -0.82624447    -0.82623731     1.1746552e-06 -8.4027315e-07 -8.4777528e-08  9.2160093      9.216          9.216          782.75858    
         4   0             -472.768       -2.1531394     -4.806912      -0.82625318    -0.82625294     2.5225728e-07 -5.2466429e-07 -4.893385e-08   9.2160093      9.216          9.216          782.75858    
         5   0             -472.768       -2.1531401     -4.8069128     -0.82625379    -0.8262536      1.5807775e-07  1.4762236e-08 -6.2083107e-09  9.2160093      9.216          9.216          782.75858    
         6   0             -472.768       -2.1531402     -4.8069128     -0.82625381    -0.82625384     2.208961e-08   3.4766881e-08 -1.1887142e-08  9.2160093      9.216          9.216          782.75858    
         7   0             -472.768       -2.1531403     -4.806913      -0.8262539     -0.82625392     6.8070991e-10  1.4393191e-08  1.1239497e-09  9.2160093      9.216          9.216          782.75858    
         8   0             -472.768       -2.1531403     -4.806913      -0.82625392    -0.82625393     9.5010787e-10  4.163454e-09   9.0852219e-10  9.2160093      9.216          9.216          782.75858    
         9   0             -472.768       -2.1531403     -4.806913      -0.82625393    -0.82625393     7.4206583e-10 -2.1599558e-10  1.3089264e-10  9.2160093      9.216          9.216          782.75858    
        10   0             -472.768       -2.1531403     -4.806913      -0.82625393    -0.82625393     1.0998618e-10 -6.4423722e-11 -8.6807273e-11  9.2160093      9.216          9.216          782.75858    
        11   0             -472.768       -2.1531403     -4.806913      -0.82625393    -0.82625393     2.2838039e-11 -5.1129938e-12  3.9085997e-11  9.2160093      9.216          9.216          782.75858    
        12   0             -472.768       -2.1531403     -4.806913      -0.82625393    -0.82625393     1.7838667e-11  1.1589453e-11  4.363088e-11   9.2160093      9.216          9.216          782.75858    
        13   0             -472.768       -2.1531403     -4.806913      -0.82625393    -0.82625393    -2.0792841e-11 -1.9429376e-11 -9.0897668e-13  9.2160093      9.216          9.216          782.75858    
        14   0             -472.768       -2.1531403     -4.806913      -0.82625393    -0.82625393    -1.0225988e-12 -1.6020714e-11 -6.5900809e-11  9.2160093      9.216          9.216          782.75858    
        15   0             -472.768       -2.1531403     -4.806913      -0.82625393    -0.82625393     1.0566854e-11  1.8179534e-12  0              9.2160093      9.216          9.216          782.75858    
        16   0             -472.768       -2.1531403     -4.806913      -0.82625393    -0.82625393     3.2950405e-11 -1.6588824e-11 -1.8634022e-11  9.2160093      9.216          9.216          782.75858    
        17   0             -472.768       -2.1531403     -4.806913      -0.82625393    -0.82625393     1.5338981e-11 -3.9085997e-11 -9.9987434e-12  9.2160093      9.216          9.216          782.75858    
        18   0             -472.768       -2.1531403     -4.806913      -0.82625393    -0.82625393    -2.0792841e-11  6.0446949e-11  3.9994974e-11  9.2160093      9.216          9.216          782.75858    
        19   0             -472.768       -2.1531403     -4.806913      -0.82625393    -0.82625393     1.363465e-12   3.158694e-11  -1.4543627e-11  9.2160093      9.216          9.216          782.75858    
Loop time of 0.0350327 on 1 procs for 17 steps with 64 atoms

99.9% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -472.767999975   -472.76800001277   -472.76800001277
  Force two-norm initial, final = 0.0010872334 1.0989081e-11
  Force max component initial, final = 0.00024560945 1.9991231e-12
  Final line search alpha, max atom move = 1 1.9991231e-12
  Iterations, force evaluations = 17 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.034738   | 0.034738   | 0.034738   |   0.0 | 99.16
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 7.7635e-05 | 7.7635e-05 | 7.7635e-05 |   0.0 |  0.22
Output  | 0.00011909 | 0.00011909 | 0.00011909 |   0.0 |  0.34
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 9.767e-05  |            |       |  0.28

Nlocal:             64 ave          64 max          64 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:            665 ave         665 max         665 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           2560 ave        2560 max        2560 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:         5120 ave        5120 max        5120 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5120
Ave neighs/atom = 80
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -472.76800001277
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -2.15314028151417
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -4.80691298043502
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -0.826253932042945
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -0.826253932064533
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 1.36346501554327e-12
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 3.15869395267524e-11
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -1.45436268324616e-11

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 480.691297987145
variable C2pos equal ${d2}
variable C2pos equal 82.6253931464835
variable C3pos equal ${d3}
variable C3pos equal 82.6253931466426
variable C4pos equal ${d4}
variable C4pos equal 1.09077164884395e-09
variable C5pos equal ${d5}
variable C5pos equal -2.43218421149333e-09
variable C6pos equal ${d6}
variable C6pos equal -1.77183382874177e-09

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(480.69552222336+${C1pos})
variable C11 equal 0.5*(480.69552222336+480.691297987145)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(82.6258230290715+${C2pos})
variable C21 equal 0.5*(82.6258230290715+82.6253931464835)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(82.6258230170502+${C3pos})
variable C31 equal 0.5*(82.6258230170502+82.6253931466426)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-4.7266885375083e-09+${C4pos})
variable C41 equal 0.5*(-4.7266885375083e-09+1.09077164884395e-09)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-4.36242372111799e-09+${C5pos})
variable C51 equal 0.5*(-4.36242372111799e-09+-2.43218421149333e-09)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(2.65808813404446e-09+${C6pos})
variable C61 equal 0.5*(2.65808813404446e-09+-1.77183382874177e-09)

# Delete dir to make sure it is not reused

variable dir delete

# uyy Perturbation

variable dir equal 2
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 9.2160000424006
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
Reading restart file ...
  restart file = 23 Jun 2022, LAMMPS = 23 Jun 2022
  restoring atom style atomic from restart
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  pair style meam stores no restart info
  64 atoms
  read_restart CPU = 0.000 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style	meam
pair_coeff * * library_ZrN.meam Zr N ZrN.meam Zr N
Reading MEAM library file library_ZrN.meam with DATE: 2015-02-12

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1e-06*${len0}
variable delta equal -1e-06*9.2160000424006
variable deltaxy equal -${up}*xy
variable deltaxy equal -1e-06*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -1e-06*xz
variable deltayz equal -${up}*yz
variable deltayz equal -1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -9.2160000424006e-06 yz delta ${deltayz} remap units box
change_box all y delta 0 -9.2160000424006e-06 yz delta -0 remap units box
Changing box ...
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.6079908 4.608) with tilt (0 0 0)
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.6079908 4.608) with tilt (0 0 0)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 500 ${maxeval}
minimize 0 1e-10 500 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.26
  ghost atom cutoff = 6.26
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 9.913 | 9.913 | 9.913 Mbytes
   Step          Temp          PotEng         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
         2   0             -472.768        2.153295       0.82641511     4.8070832      0.82638682     2.5054492e-06  5.2889732e-07  4.2277085e-06  9.216          9.2159908      9.216          782.75702    
         3   0             -472.768        2.153169       0.82626736     4.8069647      0.82627485     1.1746444e-06 -8.4029313e-07 -8.4749064e-08  9.216          9.2159908      9.216          782.75702    
         4   0             -472.768        2.1531581      0.82625919     4.806956       0.82625922     2.522129e-07  -5.2469068e-07 -4.9014393e-08  9.216          9.2159908      9.216          782.75702    
         5   0             -472.768        2.1531574      0.82625838     4.8069554      0.82625856     1.5806068e-07  1.4720339e-08 -6.1642377e-09  9.216          9.2159908      9.216          782.75702    
         6   0             -472.768        2.1531573      0.82625838     4.8069553      0.82625833     2.2045683e-08  3.4740022e-08 -1.1886712e-08  9.216          9.2159908      9.216          782.75702    
         7   0             -472.768        2.1531572      0.82625825     4.8069552      0.82625824     6.5207845e-10  1.4369246e-08  1.0453253e-09  9.216          9.2159908      9.216          782.75702    
         8   0             -472.768        2.1531572      0.82625823     4.8069552      0.82625823     8.962528e-10   4.1941404e-09  1.0044212e-09  9.216          9.2159908      9.216          782.75702    
         9   0             -472.768        2.1531572      0.82625823     4.8069552      0.82625823     7.4786206e-10 -2.3451645e-10  1.4543656e-10  9.216          9.2159908      9.216          782.75702    
        10   0             -472.768        2.1531572      0.82625823     4.8069552      0.82625823     1.4350498e-10 -1.1294058e-10  3.635914e-12   9.216          9.2159908      9.216          782.75702    
        11   0             -472.768        2.1531572      0.82625823     4.8069552      0.82625823     6.0219825e-11 -2.4315175e-11  2.2724462e-12  9.216          9.2159908      9.216          782.75702    
        12   0             -472.768        2.1531572      0.82625823     4.8069552      0.82625823     4.1472144e-11 -3.0337157e-11 -2.5905887e-11  9.216          9.2159908      9.216          782.75702    
        13   0             -472.768        2.1531572      0.82625823     4.8069552      0.82625823     2.8291956e-11  3.2723226e-11  7.7263172e-12  9.216          9.2159908      9.216          782.75702    
        14   0             -472.768        2.1531572      0.82625823     4.8069552      0.82625823    -2.0452016e-11  3.4086694e-13  7.7263172e-12  9.216          9.2159908      9.216          782.75702    
        15   0             -472.768        2.1531572      0.82625823     4.8069552      0.82625823     1.3975544e-11  1.9315793e-11 -6.4537473e-11  9.216          9.2159908      9.216          782.75702    
        16   0             -472.768        2.1531572      0.82625823     4.8069552      0.82625823    -4.0904032e-12  2.9200934e-11  3.045078e-11   9.216          9.2159908      9.216          782.75702    
        17   0             -472.768        2.1531572      0.82625823     4.8069552      0.82625823    -2.4996909e-12  2.1247372e-11 -2.1360995e-11  9.216          9.2159908      9.216          782.75702    
        18   0             -472.768        2.1531572      0.82625823     4.8069552      0.82625823     4.3290101e-11  3.2041492e-11 -6.8173387e-12  9.216          9.2159908      9.216          782.75702    
        19   0             -472.768        2.1531572      0.82625823     4.8069552      0.82625823    -1.3066566e-11 -2.9541801e-11 -9.0897849e-13  9.216          9.2159908      9.216          782.75702    
Loop time of 0.0358074 on 1 procs for 17 steps with 64 atoms

99.5% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -472.767999975   -472.76800001277  -472.768000012769
  Force two-norm initial, final = 0.0010872387 1.0986009e-11
  Force max component initial, final = 0.00024560952 1.8821611e-12
  Final line search alpha, max atom move = 1 1.8821611e-12
  Iterations, force evaluations = 17 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.035499   | 0.035499   | 0.035499   |   0.0 | 99.14
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 8.1092e-05 | 8.1092e-05 | 8.1092e-05 |   0.0 |  0.23
Output  | 0.000148   | 0.000148   | 0.000148   |   0.0 |  0.41
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 7.95e-05   |            |       |  0.22

Nlocal:             64 ave          64 max          64 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:            665 ave         665 max         665 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           2560 ave        2560 max        2560 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:         5120 ave        5120 max        5120 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5120
Ave neighs/atom = 80
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 0.826258229651152
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 4.80695522162108
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 0.826258229680564
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -1.30665658653953e-11
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -2.95418010869806e-11
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -9.08978494984019e-13

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 82.6258230214718
variable C2neg equal ${d2}
variable C2neg equal 480.695522219919
variable C3neg equal ${d3}
variable C3neg equal 82.6258230278671
variable C4neg equal ${d4}
variable C4neg equal 2.72693184903808e-10
variable C5neg equal ${d5}
variable C5neg equal -3.68068984987997e-09
variable C6neg equal ${d6}
variable C6neg equal 3.2883074064791e-10

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
Reading restart file ...
  restart file = 23 Jun 2022, LAMMPS = 23 Jun 2022
  restoring atom style atomic from restart
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  pair style meam stores no restart info
  64 atoms
  read_restart CPU = 0.000 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style	meam
pair_coeff * * library_ZrN.meam Zr N ZrN.meam Zr N
Reading MEAM library file library_ZrN.meam with DATE: 2015-02-12

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1e-06*${len0}
variable delta equal 1e-06*9.2160000424006
variable deltaxy equal ${up}*xy
variable deltaxy equal 1e-06*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1e-06*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 9.2160000424006e-06 yz delta ${deltayz} remap units box
change_box all y delta 0 9.2160000424006e-06 yz delta 0 remap units box
Changing box ...
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.6080092 4.608) with tilt (0 0 0)
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.6080092 4.608) with tilt (0 0 0)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 500 ${maxeval}
minimize 0 1e-10 500 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.26
  ghost atom cutoff = 6.26
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 9.913 | 9.913 | 9.913 Mbytes
   Step          Temp          PotEng         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
         2   0             -472.768       -2.1530025     -0.82609705    -4.806785      -0.82612534     2.5055122e-06  5.2888285e-07  4.2276978e-06  9.216          9.2160093      9.216          782.75858    
         3   0             -472.768       -2.1531285     -0.8262448     -4.8069035     -0.82623731     1.1746577e-06 -8.4026452e-07 -8.483752e-08   9.216          9.2160093      9.216          782.75858    
         4   0             -472.768       -2.1531394     -0.82625297    -4.8069122     -0.82625294     2.5223682e-07 -5.2463986e-07 -4.9007478e-08  9.216          9.2160093      9.216          782.75858    
         5   0             -472.768       -2.1531401     -0.82625379    -4.8069128     -0.8262536      1.5807661e-07  1.476269e-08  -6.2078562e-09  9.216          9.2160093      9.216          782.75858    
         6   0             -472.768       -2.1531402     -0.82625378    -4.8069129     -0.82625384     2.2052115e-08  3.4714387e-08 -1.1866236e-08  9.216          9.2160093      9.216          782.75858    
         7   0             -472.768       -2.1531403     -0.82625391    -4.806913      -0.82625392     6.2242178e-10  1.4353537e-08  1.1184958e-09  9.216          9.2160093      9.216          782.75858    
         8   0             -472.768       -2.1531403     -0.82625393    -4.806913      -0.82625393     9.3022401e-10  4.1462971e-09  8.8352533e-10  9.216          9.2160093      9.216          782.75858    
         9   0             -472.768       -2.1531403     -0.82625393    -4.806913      -0.82625393     7.3831631e-10 -2.8632765e-10  1.8224982e-10  9.216          9.2160093      9.216          782.75858    
        10   0             -472.768       -2.1531403     -0.82625393    -4.806913      -0.82625393     1.5213997e-10 -9.9078458e-11 -6.8627739e-11  9.216          9.2160093      9.216          782.75858    
        11   0             -472.768       -2.1531403     -0.82625393    -4.806913      -0.82625393     4.8857496e-12 -2.5110481e-11  6.1355926e-11  9.216          9.2160093      9.216          782.75858    
        12   0             -472.768       -2.1531403     -0.82625393    -4.806913      -0.82625393     2.124733e-11  -3.4086625e-12  3.817702e-11   9.216          9.2160093      9.216          782.75858    
        13   0             -472.768       -2.1531403     -0.82625393    -4.806913      -0.82625393    -2.2838039e-11 -1.7043313e-12  7.4990576e-11  9.216          9.2160093      9.216          782.75858    
        14   0             -472.768       -2.1531403     -0.82625393    -4.806913      -0.82625393     1.2498429e-11 -3.1814184e-11 -6.3628367e-12  9.216          9.2160093      9.216          782.75858    
        15   0             -472.768       -2.1531403     -0.82625393    -4.806913      -0.82625393    -2.2724417e-12 -1.6816069e-11  3.4995602e-11  9.216          9.2160093      9.216          782.75858    
        16   0             -472.768       -2.1531403     -0.82625393    -4.806913      -0.82625393    -4.5448834e-12  2.4087882e-11 -6.8173251e-12  9.216          9.2160093      9.216          782.75858    
        17   0             -472.768       -2.1531403     -0.82625393    -4.806913      -0.82625393    -3.6359067e-12  3.8631509e-12 -3.7722532e-11  9.216          9.2160093      9.216          782.75858    
        18   0             -472.768       -2.1531403     -0.82625393    -4.806913      -0.82625393     1.9770243e-11 -5.2607025e-11  8.5443808e-11  9.216          9.2160093      9.216          782.75858    
        19   0             -472.768       -2.1531403     -0.82625393    -4.806913      -0.82625393     1.9202132e-11  3.6245445e-11  4.1358439e-11  9.216          9.2160093      9.216          782.75858    
Loop time of 0.03497 on 1 procs for 17 steps with 64 atoms

99.9% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
     -472.767999975001   -472.76800001277   -472.76800001277
  Force two-norm initial, final = 0.0010872342 1.0977035e-11
  Force max component initial, final = 0.00024560959 1.9333424e-12
  Final line search alpha, max atom move = 1 1.9333424e-12
  Iterations, force evaluations = 17 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.034701   | 0.034701   | 0.034701   |   0.0 | 99.23
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 7.685e-05  | 7.685e-05  | 7.685e-05  |   0.0 |  0.22
Output  | 0.00011578 | 0.00011578 | 0.00011578 |   0.0 |  0.33
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 7.665e-05  |            |       |  0.22

Nlocal:             64 ave          64 max          64 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:            665 ave         665 max         665 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           2560 ave        2560 max        2560 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:         5120 ave        5120 max        5120 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5120
Ave neighs/atom = 80
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -472.76800001277
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -2.15314028158155
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -0.826253932184805
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -4.80691298041329
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -0.826253932146569
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 1.92021323022344e-11
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 3.62454449965253e-11
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 4.13584388048125e-11

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 82.6253931621239
variable C2pos equal ${d2}
variable C2pos equal 480.691297983518
variable C3pos equal ${d3}
variable C3pos equal 82.6253931548462
variable C4pos equal ${d4}
variable C4pos equal -4.49943491488346e-09
variable C5pos equal ${d5}
variable C5pos equal -2.89803475847062e-09
variable C6pos equal ${d6}
variable C6pos equal -3.55570055741088e-09

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(82.6258230214718+${C1pos})
variable C12 equal 0.5*(82.6258230214718+82.6253931621239)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(480.695522219919+${C2pos})
variable C22 equal 0.5*(480.695522219919+480.691297983518)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(82.6258230278671+${C3pos})
variable C32 equal 0.5*(82.6258230278671+82.6253931548462)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(2.72693184903808e-10+${C4pos})
variable C42 equal 0.5*(2.72693184903808e-10+-4.49943491488346e-09)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-3.68068984987997e-09+${C5pos})
variable C52 equal 0.5*(-3.68068984987997e-09+-2.89803475847062e-09)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(3.2883074064791e-10+${C6pos})
variable C62 equal 0.5*(3.2883074064791e-10+-3.55570055741088e-09)

# Delete dir to make sure it is not reused

variable dir delete

# uzz Perturbation

variable dir equal 3
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 9.2160000424006
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
Reading restart file ...
  restart file = 23 Jun 2022, LAMMPS = 23 Jun 2022
  restoring atom style atomic from restart
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  pair style meam stores no restart info
  64 atoms
  read_restart CPU = 0.000 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style	meam
pair_coeff * * library_ZrN.meam Zr N ZrN.meam Zr N
Reading MEAM library file library_ZrN.meam with DATE: 2015-02-12

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1e-06*${len0}
variable delta equal -1e-06*9.2160000424006
variable deltaxy equal -${up}*xy
variable deltaxy equal -1e-06*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -1e-06*xz
variable deltayz equal -${up}*yz
variable deltayz equal -1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -9.2160000424006e-06 remap units box
Changing box ...
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.6079908) with tilt (0 0 0)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 500 ${maxeval}
minimize 0 1e-10 500 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.26
  ghost atom cutoff = 6.26
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 9.913 | 9.913 | 9.913 Mbytes
   Step          Temp          PotEng         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
         2   0             -472.768        2.153295       0.82641511     0.82638617     4.8070838      2.5055142e-06  5.2880358e-07  4.227729e-06   9.216          9.216          9.2159908      782.75702    
         3   0             -472.768        2.153169       0.82626736     0.82626769     4.8069718      1.1746504e-06 -8.402487e-07  -8.4814511e-08  9.216          9.216          9.2159908      782.75702    
         4   0             -472.768        2.1531581      0.82625919     0.82625898     4.8069562      2.5226255e-07 -5.2469591e-07 -4.9073931e-08  9.216          9.216          9.2159908      782.75702    
         5   0             -472.768        2.1531574      0.82625838     0.82625837     4.8069556      1.5809102e-07  1.4737723e-08 -6.1760544e-09  9.216          9.216          9.2159908      782.75702    
         6   0             -472.768        2.1531573      0.82625838     0.82625835     4.8069553      2.2049546e-08  3.4697868e-08 -1.1824901e-08  9.216          9.216          9.2159908      782.75702    
         7   0             -472.768        2.1531572      0.82625825     0.82625826     4.8069552      6.2219578e-10  1.4355043e-08  1.1671284e-09  9.216          9.216          9.2159908      782.75702    
         8   0             -472.768        2.1531572      0.82625823     0.82625824     4.8069552      9.2943051e-10  4.217433e-09   9.9260452e-10  9.216          9.216          9.2159908      782.75702    
         9   0             -472.768        2.1531572      0.82625823     0.82625823     4.8069552      7.0195864e-10 -2.4758302e-10  1.4725452e-10  9.216          9.216          9.2159908      782.75702    
        10   0             -472.768        2.1531572      0.82625823     0.82625823     4.8069552      2.072471e-10  -8.9420759e-11  7.9081129e-11  9.216          9.216          9.2159908      782.75702    
        11   0             -472.768        2.1531572      0.82625823     0.82625823     4.8069552      4.2835612e-11  3.4768427e-11 -2.4996909e-11  9.216          9.216          9.2159908      782.75702    
        12   0             -472.768        2.1531572      0.82625823     0.82625823     4.8069552      1.3861922e-11  2.1815484e-11 -2.1360995e-11  9.216          9.216          9.2159908      782.75702    
        13   0             -472.768        2.1531572      0.82625823     0.82625823     4.8069552      3.9654187e-11 -1.1362231e-13  1.7725081e-11  9.216          9.216          9.2159908      782.75702    
        14   0             -472.768        2.1531572      0.82625823     0.82625823     4.8069552     -1.033963e-11  -2.999629e-11  -1.4089167e-11  9.216          9.216          9.2159908      782.75702    
        15   0             -472.768        2.1531572      0.82625823     0.82625823     4.8069552     -1.4316411e-11  3.2382359e-11 -1.1953067e-10  9.216          9.216          9.2159908      782.75702    
        16   0             -472.768        2.1531572      0.82625823     0.82625823     4.8069552      1.1021364e-11 -2.1360995e-11  5.9992581e-11  9.216          9.216          9.2159908      782.75702    
        17   0             -472.768        2.1531572      0.82625823     0.82625823     4.8069552     -6.7037164e-12  2.897369e-11   2.999629e-11   9.216          9.216          9.2159908      782.75702    
        18   0             -472.768        2.1531572      0.82625823     0.82625823     4.8069552     -1.9883905e-11  1.817957e-12  -5.5902177e-11  9.216          9.216          9.2159908      782.75702    
        19   0             -472.768        2.1531572      0.82625823     0.82625823     4.8069552     -1.1362231e-13  7.3854503e-12 -3.2268737e-11  9.216          9.216          9.2159908      782.75702    
Loop time of 0.0356314 on 1 procs for 17 steps with 64 atoms

99.8% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -472.767999975  -472.768000012769  -472.768000012769
  Force two-norm initial, final = 0.0010872386 1.0979181e-11
  Force max component initial, final = 0.00024561139 1.926459e-12
  Final line search alpha, max atom move = 1 1.926459e-12
  Iterations, force evaluations = 17 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.035333   | 0.035333   | 0.035333   |   0.0 | 99.16
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 8.1866e-05 | 8.1866e-05 | 8.1866e-05 |   0.0 |  0.23
Output  | 0.00013909 | 0.00013909 | 0.00013909 |   0.0 |  0.39
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 7.725e-05  |            |       |  0.22

Nlocal:             64 ave          64 max          64 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:            665 ave         665 max         665 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           2560 ave        2560 max        2560 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:         5120 ave        5120 max        5120 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5120
Ave neighs/atom = 80
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 0.826258229767554
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 0.826258229812138
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 4.80695522162767
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -1.13622311873002e-13
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 7.38545027174516e-12
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -3.22687365719327e-11

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 82.625823033112
variable C2neg equal ${d2}
variable C2neg equal 82.6258230390248
variable C3neg equal ${d3}
variable C3neg equal 480.695522222578
variable C4neg equal ${d4}
variable C4neg equal -2.86328262279106e-09
variable C5neg equal ${d5}
variable C5neg equal 1.2035285992604e-11
variable C6neg equal ${d6}
variable C6neg equal 1.62412509600014e-09

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
Reading restart file ...
  restart file = 23 Jun 2022, LAMMPS = 23 Jun 2022
  restoring atom style atomic from restart
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  pair style meam stores no restart info
  64 atoms
  read_restart CPU = 0.000 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style	meam
pair_coeff * * library_ZrN.meam Zr N ZrN.meam Zr N
Reading MEAM library file library_ZrN.meam with DATE: 2015-02-12

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1e-06*${len0}
variable delta equal 1e-06*9.2160000424006
variable deltaxy equal ${up}*xy
variable deltaxy equal 1e-06*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1e-06*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 9.2160000424006e-06 remap units box
Changing box ...
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.6080092) with tilt (0 0 0)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 500 ${maxeval}
minimize 0 1e-10 500 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.26
  ghost atom cutoff = 6.26
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 9.913 | 9.913 | 9.913 Mbytes
   Step          Temp          PotEng         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
         2   0             -472.768       -2.1530025     -0.82609705    -0.82612599    -4.8067844      2.5055302e-06  5.2893762e-07  4.2275215e-06  9.216          9.216          9.2160093      782.75858    
         3   0             -472.768       -2.1531285     -0.8262448     -0.82624447    -4.8068964      1.1746532e-06 -8.4028781e-07 -8.4753894e-08  9.216          9.216          9.2160093      782.75858    
         4   0             -472.768       -2.1531394     -0.82625297    -0.82625318    -4.806912       2.5222842e-07 -5.2464259e-07 -4.8970664e-08  9.216          9.216          9.2160093      782.75858    
         5   0             -472.768       -2.1531401     -0.82625379    -0.82625379    -4.8069127      1.5810036e-07  1.4772689e-08 -6.1496817e-09  9.216          9.216          9.2160093      782.75858    
         6   0             -472.768       -2.1531402     -0.82625378    -0.82625381    -4.8069129      2.2068817e-08  3.4739612e-08 -1.1821242e-08  9.216          9.216          9.2160093      782.75858    
         7   0             -472.768       -2.1531403     -0.82625391    -0.8262539     -4.806913       6.0185618e-10  1.4336153e-08  1.168035e-09   9.216          9.216          9.2160093      782.75858    
         8   0             -472.768       -2.1531403     -0.82625393    -0.82625392    -4.806913       9.1840731e-10  4.1928822e-09  9.3988188e-10  9.216          9.216          9.2160093      782.75858    
         9   0             -472.768       -2.1531403     -0.82625393    -0.82625393    -4.806913       7.4399741e-10 -2.3485685e-10  1.0498681e-10  9.216          9.216          9.2160093      782.75858    
        10   0             -472.768       -2.1531403     -0.82625393    -0.82625393    -4.806913       1.2509792e-10 -1.003283e-10  -6.3628367e-12  9.216          9.216          9.2160093      782.75858    
        11   0             -472.768       -2.1531403     -0.82625393    -0.82625393    -4.806913       1.306654e-11  -2.670119e-11   2.2724417e-11  9.216          9.216          9.2160093      782.75858    
        12   0             -472.768       -2.1531403     -0.82625393    -0.82625393    -4.806913       1.8634022e-11 -2.6246702e-11 -5.5447577e-11  9.216          9.216          9.2160093      782.75858    
        13   0             -472.768       -2.1531403     -0.82625393    -0.82625393    -4.806913      -2.9655364e-11  9.0897668e-12  2.0906464e-11  9.216          9.216          9.2160093      782.75858    
        14   0             -472.768       -2.1531403     -0.82625393    -0.82625393    -4.806913       2.0338353e-11 -2.0792841e-11 -6.1810414e-11  9.216          9.216          9.2160093      782.75858    
        15   0             -472.768       -2.1531403     -0.82625393    -0.82625393    -4.806913       2.4655992e-11 -1.5566226e-11  4.1358439e-11  9.216          9.216          9.2160093      782.75858    
        16   0             -472.768       -2.1531403     -0.82625393    -0.82625393    -4.806913      -1.1816697e-11 -3.1814184e-11 -5.6811042e-11  9.216          9.216          9.2160093      782.75858    
        17   0             -472.768       -2.1531403     -0.82625393    -0.82625393    -4.806913       2.2951661e-11 -1.5338981e-11 -1.4998115e-11  9.216          9.216          9.2160093      782.75858    
        18   0             -472.768       -2.1531403     -0.82625393    -0.82625393    -4.806913      -1.4430005e-11  2.0906464e-11  3.9994974e-11  9.216          9.216          9.2160093      782.75858    
        19   0             -472.768       -2.1531403     -0.82625393    -0.82625393    -4.806913      -1.1816697e-11  2.0906464e-11 -2.4996859e-11  9.216          9.216          9.2160093      782.75858    
Loop time of 0.0353618 on 1 procs for 17 steps with 64 atoms

99.9% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -472.767999975  -472.768000012769  -472.768000012769
  Force two-norm initial, final = 0.0010872343 1.0980542e-11
  Force max component initial, final = 0.00024560772 1.8745703e-12
  Final line search alpha, max atom move = 1 1.8745703e-12
  Iterations, force evaluations = 17 34

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.035089   | 0.035089   | 0.035089   |   0.0 | 99.23
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 8.0669e-05 | 8.0669e-05 | 8.0669e-05 |   0.0 |  0.23
Output  | 0.00011791 | 0.00011791 | 0.00011791 |   0.0 |  0.33
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 7.465e-05  |            |       |  0.21

Nlocal:             64 ave          64 max          64 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:            665 ave         665 max         665 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           2560 ave        2560 max        2560 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:         5120 ave        5120 max        5120 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5120
Ave neighs/atom = 80
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -472.768000012769
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -2.15314028155092
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -0.826253932136316
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -0.826253932159749
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -4.8069129803567
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -1.1816696801375e-11
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 2.09064635716635e-11
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -2.49968586182933e-11

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 82.625393157275
variable C2pos equal ${d2}
variable C2pos equal 82.6253931581639
variable C3pos equal ${d3}
variable C3pos equal 480.691297975859
variable C4pos equal ${d4}
variable C4pos equal 2.13609482742712e-09
variable C5pos equal ${d5}
variable C5pos equal -1.36413661598444e-09
variable C6pos equal ${d6}
variable C6pos equal -4.5381764704994e-10

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(82.625823033112+${C1pos})
variable C13 equal 0.5*(82.625823033112+82.625393157275)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(82.6258230390248+${C2pos})
variable C23 equal 0.5*(82.6258230390248+82.6253931581639)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(480.695522222578+${C3pos})
variable C33 equal 0.5*(480.695522222578+480.691297975859)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-2.86328262279106e-09+${C4pos})
variable C43 equal 0.5*(-2.86328262279106e-09+2.13609482742712e-09)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(1.2035285992604e-11+${C5pos})
variable C53 equal 0.5*(1.2035285992604e-11+-1.36413661598444e-09)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(1.62412509600014e-09+${C6pos})
variable C63 equal 0.5*(1.62412509600014e-09+-4.5381764704994e-10)

# Delete dir to make sure it is not reused

variable dir delete

# uyz Perturbation

variable dir equal 4
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 9.2160000424006
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
Reading restart file ...
  restart file = 23 Jun 2022, LAMMPS = 23 Jun 2022
  restoring atom style atomic from restart
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  pair style meam stores no restart info
  64 atoms
  read_restart CPU = 0.000 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style	meam
pair_coeff * * library_ZrN.meam Zr N ZrN.meam Zr N
Reading MEAM library file library_ZrN.meam with DATE: 2015-02-12

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1e-06*${len0}
variable delta equal -1e-06*9.2160000424006
variable deltaxy equal -${up}*xy
variable deltaxy equal -1e-06*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -1e-06*xz
variable deltayz equal -${up}*yz
variable deltayz equal -1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -9.2160000424006e-06 remap units box
Changing box ...
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 0 -9.216e-06)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 500 ${maxeval}
minimize 0 1e-10 500 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.26
  ghost atom cutoff = 6.26
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 9.913 | 9.913 | 9.913 Mbytes
   Step          Temp          PotEng         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
         2   0             -472.768        0.00013779623  0.00015654032  0.00012786294  0.00012898542  2.5055017e-06  5.2894201e-07  1.2287484      9.216          9.216          9.216          782.7578     
         3   0             -472.768        1.1727678e-05  8.7881785e-06  9.3856517e-06  1.7009203e-05  1.1746634e-06 -8.4027149e-07  1.2287441      9.216          9.216          9.216          782.7578     
         4   0             -472.768        8.9129272e-07  6.2217735e-07  6.7292701e-07  1.3787738e-06  2.5225048e-07 -5.2467936e-07  1.2287442      9.216          9.216          9.216          782.7578     
         5   0             -472.768        1.9632587e-07 -1.9300059e-07  6.2564927e-08  7.1941326e-07  1.5810074e-07  1.4746343e-08  1.2287442      9.216          9.216          9.216          782.7578     
         6   0             -472.768        1.1365963e-07 -1.9021329e-07  4.4651706e-08  4.8654048e-07  2.2072248e-08  3.4723853e-08  1.2287442      9.216          9.216          9.216          782.7578     
         7   0             -472.768        1.2586951e-08 -3.1798002e-07 -4.9681988e-08  4.0542286e-07  6.6548522e-10  1.4377526e-08  1.2287442      9.216          9.216          9.216          782.7578     
         8   0             -472.768       -3.4650514e-09 -3.3557052e-07 -6.9607686e-08  3.9478305e-07  9.0568254e-10  4.2089071e-09  1.2287442      9.216          9.216          9.216          782.7578     
         9   0             -472.768       -6.4412702e-09 -3.3808248e-07 -7.3828523e-08  3.9258719e-07  6.6309915e-10 -2.6814839e-10  1.2287442      9.216          9.216          9.216          782.7578     
        10   0             -472.768       -8.2683233e-09 -3.3908692e-07 -7.6364116e-08  3.9064607e-07  1.6157077e-10 -1.4191413e-10  1.2287442      9.216          9.216          9.216          782.7578     
        11   0             -472.768       -8.7612717e-09 -3.396477e-07  -7.6811333e-08  3.9017522e-07  1.4770886e-12  1.5907108e-11  1.2287442      9.216          9.216          9.216          782.7578     
        12   0             -472.768       -8.8860814e-09 -3.3985715e-07 -7.6933136e-08  3.9013204e-07  5.7947321e-11  4.4312657e-12  1.2287442      9.216          9.216          9.216          782.7578     
        13   0             -472.768       -8.8550521e-09 -3.398661e-07  -7.6966768e-08  3.9026771e-07 -2.4201528e-11  5.6811099e-13  1.2287442      9.216          9.216          9.216          782.7578     
        14   0             -472.768       -8.8735975e-09 -3.3990446e-07 -7.6983584e-08  3.9026725e-07 -3.9313281e-11 -3.7381703e-11  1.2287442      9.216          9.216          9.216          782.7578     
        15   0             -472.768       -8.8873653e-09 -3.3993599e-07 -7.6922683e-08  3.9019658e-07  1.136222e-13   7.4536162e-11  1.2287442      9.216          9.216          9.216          782.7578     
        16   0             -472.768       -8.9497135e-09 -3.3994124e-07 -7.6976767e-08  3.9006887e-07  2.272444e-11  -7.9421917e-11  1.2287442      9.216          9.216          9.216          782.7578     
        17   0             -472.768       -8.8288607e-09 -3.3976753e-07 -7.6897231e-08  3.9017817e-07  9.4306425e-12  6.7037097e-12  1.2287442      9.216          9.216          9.216          782.7578     
        18   0             -472.768       -8.7905275e-09 -3.3982796e-07 -7.6852691e-08  3.9030907e-07  1.2157575e-11 -2.1020107e-11  1.2287442      9.216          9.216          9.216          782.7578     
Loop time of 0.0337239 on 1 procs for 16 steps with 64 atoms

99.9% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
     -472.767999975874  -472.768000013643  -472.768000013643
  Force two-norm initial, final = 0.0010872365 9.3595041e-11
  Force max component initial, final = 0.00024560956 1.9227361e-11
  Final line search alpha, max atom move = 1 1.9227361e-11
  Iterations, force evaluations = 16 32

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.033469   | 0.033469   | 0.033469   |   0.0 | 99.24
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 7.5173e-05 | 7.5173e-05 | 7.5173e-05 |   0.0 |  0.22
Output  | 0.00010976 | 0.00010976 | 0.00010976 |   0.0 |  0.33
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 7.044e-05  |            |       |  0.21

Nlocal:             64 ave          64 max          64 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:            665 ave         665 max         665 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           2560 ave        2560 max        2560 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:         5120 ave        5120 max        5120 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5120
Ave neighs/atom = 80
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -3.39827958189778e-07
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -7.68526914303881e-08
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 3.90309067076463e-07
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 1.21575752128239e-11
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -2.10201066763777e-11
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 1.22874421103964

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -3.39264392112665e-05
variable C2neg equal ${d2}
variable C2neg equal -7.62745816856886e-06
variable C3neg equal ${d3}
variable C3neg equal 3.90907174328055e-05
variable C4neg equal ${d4}
variable C4neg equal 122.874421104328
variable C5neg equal ${d5}
variable C5neg equal -2.82852040881968e-09
variable C6neg equal ${d6}
variable C6neg equal 2.85124484846983e-09

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
Reading restart file ...
  restart file = 23 Jun 2022, LAMMPS = 23 Jun 2022
  restoring atom style atomic from restart
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  pair style meam stores no restart info
  64 atoms
  read_restart CPU = 0.000 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style	meam
pair_coeff * * library_ZrN.meam Zr N ZrN.meam Zr N
Reading MEAM library file library_ZrN.meam with DATE: 2015-02-12

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1e-06*${len0}
variable delta equal 1e-06*9.2160000424006
variable deltaxy equal ${up}*xy
variable deltaxy equal 1e-06*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1e-06*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 9.2160000424006e-06 remap units box
Changing box ...
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 0 9.216e-06)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 500 ${maxeval}
minimize 0 1e-10 500 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.26
  ghost atom cutoff = 6.26
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 9.913 | 9.913 | 9.913 Mbytes
   Step          Temp          PotEng         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
         2   0             -472.768        0.00013779612  0.00015654029  0.00012786276  0.0001289853   2.5055791e-06  5.2887725e-07 -1.22874        9.216          9.216          9.216          782.7578     
         3   0             -472.768        1.1727602e-05  8.7880766e-06  9.3855835e-06  1.7009147e-05  1.1746297e-06 -8.4029547e-07 -1.2287443      9.216          9.216          9.216          782.7578     
         4   0             -472.768        8.9133732e-07  6.223657e-07   6.7288975e-07  1.3787565e-06  2.5221594e-07 -5.2470731e-07 -1.2287443      9.216          9.216          9.216          782.7578     
         5   0             -472.768        1.9631197e-07 -1.9300547e-07  6.2547202e-08  7.1939418e-07  1.5809881e-07  1.4777362e-08 -1.2287442      9.216          9.216          9.216          782.7578     
         6   0             -472.768        1.1361878e-07 -1.9018131e-07  4.457717e-08   4.8646049e-07  2.2049183e-08  3.4762825e-08 -1.2287442      9.216          9.216          9.216          782.7578     
         7   0             -472.768        1.2484221e-08 -3.1804506e-07 -4.9787429e-08  4.0528515e-07  6.7037097e-10  1.4270494e-08 -1.2287442      9.216          9.216          9.216          782.7578     
         8   0             -472.768       -3.5372152e-09 -3.3561954e-07 -6.9547239e-08  3.9455513e-07  8.757999e-10   4.1564136e-09 -1.2287442      9.216          9.216          9.216          782.7578     
         9   0             -472.768       -6.457578e-09  -3.3807482e-07 -7.3774893e-08  3.9247698e-07  7.3797618e-10 -2.6337626e-10 -1.2287442      9.216          9.216          9.216          782.7578     
        10   0             -472.768       -8.2756534e-09 -3.3909233e-07 -7.630685e-08   3.9057222e-07  1.724785e-10  -5.1584478e-11 -1.2287442      9.216          9.216          9.216          782.7578     
        11   0             -472.768       -8.7031122e-09 -3.3963366e-07 -7.6813605e-08  3.9033793e-07 -1.1589464e-11  9.5442647e-12 -1.2287442      9.216          9.216          9.216          782.7578     
        12   0             -472.768       -8.8249442e-09 -3.3982349e-07 -7.6864508e-08  3.9021317e-07 -1.2612064e-11 -8.2944205e-12 -1.2287442      9.216          9.216          9.216          782.7578     
        13   0             -472.768       -8.8785936e-09 -3.3982219e-07 -7.6961769e-08  3.9014818e-07 -9.0897759e-12  2.9541772e-12 -1.2287442      9.216          9.216          9.216          782.7578     
        14   0             -472.768       -8.8372049e-09 -3.3982937e-07 -7.6888142e-08  3.902059e-07  -4.9880145e-11  4.5448879e-12 -1.2287442      9.216          9.216          9.216          782.7578     
        15   0             -472.768       -8.8146638e-09 -3.3986151e-07 -7.6944953e-08  3.9036247e-07  1.1930331e-11 -3.8631547e-11 -1.2287442      9.216          9.216          9.216          782.7578     
        16   0             -472.768       -8.9138827e-09 -3.399426e-07  -7.6998128e-08  3.9019908e-07 -2.1815462e-11  9.4306425e-12 -1.2287442      9.216          9.216          9.216          782.7578     
        17   0             -472.768       -8.8217554e-09 -3.3982893e-07 -7.6939953e-08  3.9030361e-07  3.0677994e-12  2.067924e-11  -1.2287442      9.216          9.216          9.216          782.7578     
        18   0             -472.768       -8.7902386e-09 -3.3974665e-07 -7.6887233e-08  3.9026316e-07 -7.2718207e-12  1.9770262e-11 -1.2287442      9.216          9.216          9.216          782.7578     
Loop time of 0.0342116 on 1 procs for 16 steps with 64 atoms

99.8% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
     -472.767999975875  -472.768000013644  -472.768000013644
  Force two-norm initial, final = 0.0010872364 9.3613743e-11
  Force max component initial, final = 0.00024560955 1.9412156e-11
  Final line search alpha, max atom move = 1 1.9412156e-11
  Iterations, force evaluations = 16 32

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.033888   | 0.033888   | 0.033888   |   0.0 | 99.05
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 7.7353e-05 | 7.7353e-05 | 7.7353e-05 |   0.0 |  0.23
Output  | 0.0001517  | 0.0001517  | 0.0001517  |   0.0 |  0.44
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 9.484e-05  |            |       |  0.28

Nlocal:             64 ave          64 max          64 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:            665 ave         665 max         665 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           2560 ave        2560 max        2560 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:         5120 ave        5120 max        5120 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5120
Ave neighs/atom = 80
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -472.768000013644
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -8.7902385581144e-09
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -3.39746646804057e-07
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -7.68872325786563e-08
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 3.9026316370837e-07
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -7.27182068804419e-12
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 1.97702624956202e-11
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -1.2287442110819

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 3.39183080726944e-05
variable C2pos equal ${d2}
variable C2pos equal 7.63091228339568e-06
variable C3pos equal ${d3}
variable C3pos equal -3.90861270959962e-05
variable C4pos equal ${d4}
variable C4pos equal 122.874421107826
variable C5pos equal ${d5}
variable C5pos equal -1.25051650838011e-09
variable C6pos equal ${d6}
variable C6pos equal -9.08305258383021e-10

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-3.39264392112665e-05+${C1pos})
variable C14 equal 0.5*(-3.39264392112665e-05+3.39183080726944e-05)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-7.62745816856886e-06+${C2pos})
variable C24 equal 0.5*(-7.62745816856886e-06+7.63091228339568e-06)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(3.90907174328055e-05+${C3pos})
variable C34 equal 0.5*(3.90907174328055e-05+-3.90861270959962e-05)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(122.874421104328+${C4pos})
variable C44 equal 0.5*(122.874421104328+122.874421107826)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-2.82852040881968e-09+${C5pos})
variable C54 equal 0.5*(-2.82852040881968e-09+-1.25051650838011e-09)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(2.85124484846983e-09+${C6pos})
variable C64 equal 0.5*(2.85124484846983e-09+-9.08305258383021e-10)

# Delete dir to make sure it is not reused

variable dir delete

# uxz Perturbation

variable dir equal 5
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 9.2160000424006
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
Reading restart file ...
  restart file = 23 Jun 2022, LAMMPS = 23 Jun 2022
  restoring atom style atomic from restart
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  pair style meam stores no restart info
  64 atoms
  read_restart CPU = 0.000 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style	meam
pair_coeff * * library_ZrN.meam Zr N ZrN.meam Zr N
Reading MEAM library file library_ZrN.meam with DATE: 2015-02-12

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1e-06*${len0}
variable delta equal -1e-06*9.2160000424006
variable deltaxy equal -${up}*xy
variable deltaxy equal -1e-06*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -1e-06*xz
variable deltayz equal -${up}*yz
variable deltayz equal -1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -9.2160000424006e-06 remap units box
Changing box ...
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 -9.216e-06 0)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 500 ${maxeval}
minimize 0 1e-10 500 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.26
  ghost atom cutoff = 6.26
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 9.913 | 9.913 | 9.913 Mbytes
   Step          Temp          PotEng         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
         2   0             -472.768        0.00013779609  0.00015680313  0.00012759994  0.0001289852   2.505498e-06   1.2287447      4.2276852e-06  9.216          9.216          9.216          782.7578     
         3   0             -472.768        1.1727634e-05  9.0509521e-06  9.1227508e-06  1.7009198e-05  1.1746614e-06  1.2287434     -8.4772159e-08  9.216          9.216          9.216          782.7578     
         4   0             -472.768        8.9125258e-07  8.8516278e-07  4.0996025e-07  1.3786347e-06  2.5223219e-07  1.2287437     -4.8969804e-08  9.216          9.216          9.216          782.7578     
         5   0             -472.768        1.9636625e-07  6.9935748e-08 -2.0030412e-07  7.1946712e-07  1.5809404e-07  1.2287442     -6.2024086e-09  9.216          9.216          9.216          782.7578     
         6   0             -472.768        1.135921e-07   7.2537921e-08 -2.1827961e-07  4.8651798e-07  2.2080315e-08  1.2287442     -1.1873974e-08  9.216          9.216          9.216          782.7578     
         7   0             -472.768        1.2508129e-08 -5.5133606e-08 -3.126442e-07   4.053022e-07   6.3867038e-10  1.2287442      1.1603099e-09  9.216          9.216          9.216          782.7578     
         8   0             -472.768       -3.4456056e-09 -7.2663137e-08 -3.3251036e-07  3.9483668e-07  8.9784261e-10  1.2287442      9.771509e-10   9.216          9.216          9.216          782.7578     
         9   0             -472.768       -6.4706063e-09 -7.5266901e-08 -3.3668984e-07  3.9254492e-07  7.0945701e-10  1.2287442      1.5043579e-10  9.216          9.216          9.216          782.7578     
        10   0             -472.768       -8.2535943e-09 -7.6271634e-08 -3.3924452e-07  3.9075538e-07  1.7372834e-10  1.2287442     -1.0771384e-10  9.216          9.216          9.216          782.7578     
        11   0             -472.768       -8.7317486e-09 -7.6755306e-08 -3.3978082e-07  3.9034088e-07 -2.4542395e-11  1.2287442      1.136222e-11   9.216          9.216          9.216          782.7578     
        12   0             -472.768       -8.8022525e-09 -7.6892509e-08 -3.3977719e-07  3.9026294e-07  6.2492209e-12  1.2287442      5.0902745e-11  9.216          9.216          9.216          782.7578     
        13   0             -472.768       -8.8502266e-09 -7.693258e-08  -3.3978764e-07  3.9016954e-07  3.1814216e-11  1.2287442     -4.4085413e-11  9.216          9.216          9.216          782.7578     
        14   0             -472.768       -8.8094249e-09 -7.6860851e-08 -3.3983172e-07  3.902643e-07   1.0566864e-11  1.2287442      7.2718207e-12  9.216          9.216          9.216          782.7578     
        15   0             -472.768       -8.9010577e-09 -7.7026445e-08 -3.3984809e-07  3.9017136e-07  7.2718207e-12  1.2287442      3.2268704e-11  9.216          9.216          9.216          782.7578     
        16   0             -472.768       -8.8370922e-09 -7.6957942e-08 -3.3982445e-07  3.9027112e-07 -1.4089153e-11  1.2287442      5.9538032e-11  9.216          9.216          9.216          782.7578     
        17   0             -472.768       -8.8316189e-09 -7.6919252e-08 -3.3987081e-07  3.9029521e-07  2.4428773e-11  1.2287442      5.9083543e-12  9.216          9.216          9.216          782.7578     
        18   0             -472.768       -8.838334e-09  -7.6930535e-08 -3.3984945e-07  3.9026498e-07  4.7380457e-11  1.2287442      5.9083543e-12  9.216          9.216          9.216          782.7578     
Loop time of 0.0347149 on 1 procs for 16 steps with 64 atoms

99.6% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
     -472.767999975874  -472.768000013643  -472.768000013643
  Force two-norm initial, final = 0.0010872365 9.3586479e-11
  Force max component initial, final = 0.00024560949 1.922125e-11
  Final line search alpha, max atom move = 1 1.922125e-11
  Iterations, force evaluations = 16 32

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.034408   | 0.034408   | 0.034408   |   0.0 | 99.12
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 7.4294e-05 | 7.4294e-05 | 7.4294e-05 |   0.0 |  0.21
Output  | 0.0001272  | 0.0001272  | 0.0001272  |   0.0 |  0.37
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0001056  |            |       |  0.30

Nlocal:             64 ave          64 max          64 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:            665 ave         665 max         665 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           2560 ave        2560 max        2560 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:         5120 ave        5120 max        5120 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5120
Ave neighs/atom = 80
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -7.69305349086649e-08
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -3.39849448833331e-07
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 3.90264981663542e-07
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 4.7380456670538e-11
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 1.22874421104418
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 5.90835430903591e-12

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -7.63669688315518e-06
variable C2neg equal ${d2}
variable C2neg equal -3.39271339088631e-05
variable C3neg equal ${d3}
variable C3neg equal 3.90863088915134e-05
variable C4neg equal ${d4}
variable C4neg equal 9.54426465305801e-10
variable C5neg equal ${d5}
variable C5neg equal 122.874421103691
variable C6neg equal ${d6}
variable C6neg equal 6.37353299424124e-09

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
Reading restart file ...
  restart file = 23 Jun 2022, LAMMPS = 23 Jun 2022
  restoring atom style atomic from restart
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  pair style meam stores no restart info
  64 atoms
  read_restart CPU = 0.000 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style	meam
pair_coeff * * library_ZrN.meam Zr N ZrN.meam Zr N
Reading MEAM library file library_ZrN.meam with DATE: 2015-02-12

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1e-06*${len0}
variable delta equal 1e-06*9.2160000424006
variable deltaxy equal ${up}*xy
variable deltaxy equal 1e-06*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1e-06*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 9.2160000424006e-06 remap units box
Changing box ...
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 9.216e-06 0)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 500 ${maxeval}
minimize 0 1e-10 500 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.26
  ghost atom cutoff = 6.26
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 9.913 | 9.913 | 9.913 Mbytes
   Step          Temp          PotEng         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
         2   0             -472.768        0.00013779626  0.00015680336  0.00012759999  0.00012898542  2.5054967e-06 -1.2287437      4.2276679e-06  9.216          9.216          9.216          782.7578     
         3   0             -472.768        1.1727651e-05  9.0509439e-06  9.122714e-06   1.7009295e-05  1.1746537e-06 -1.2287451     -8.4848967e-08  9.216          9.216          9.216          782.7578     
         4   0             -472.768        8.9132982e-07  8.8524268e-07  4.1004888e-07  1.3786979e-06  2.5222515e-07 -1.2287447     -4.9003436e-08  9.216          9.216          9.216          782.7578     
         5   0             -472.768        1.9623492e-07  6.9774241e-08 -2.0031185e-07  7.1924238e-07  1.5808404e-07 -1.2287442     -6.1855925e-09  9.216          9.216          9.216          782.7578     
         6   0             -472.768        1.1365277e-07  7.2701743e-08 -2.1826461e-07  4.8652116e-07  2.2103494e-08 -1.2287442     -1.1739446e-08  9.216          9.216          9.216          782.7578     
         7   0             -472.768        1.2598402e-08 -5.5125026e-08 -3.1247377e-07  4.05394e-07    6.2730816e-10 -1.2287442      1.1057712e-09  9.216          9.216          9.216          782.7578     
         8   0             -472.768       -3.5329371e-09 -7.271993e-08  -3.3254445e-07  3.9466557e-07  9.1920358e-10 -1.2287442      1.0016933e-09  9.216          9.216          9.216          782.7578     
         9   0             -472.768       -6.3993649e-09 -7.5138848e-08 -3.3669484e-07  3.926356e-07   7.2434151e-10 -1.2287442      1.4407295e-10  9.216          9.216          9.216          782.7578     
        10   0             -472.768       -8.2591596e-09 -7.6218793e-08 -3.3923634e-07  3.9067766e-07  1.5566241e-10 -1.2287442     -7.9535539e-11  9.216          9.216          9.216          782.7578     
        11   0             -472.768       -8.7751007e-09 -7.6830142e-08 -3.3968038e-07  3.9018522e-07  7.3854429e-12 -1.2287442      6.771883e-11   9.216          9.216          9.216          782.7578     
        12   0             -472.768       -8.7710463e-09 -7.6882062e-08 -3.3967493e-07  3.9024385e-07 -4.4199035e-11 -1.2287442      6.771883e-11   9.216          9.216          9.216          782.7578     
        13   0             -472.768       -8.9043255e-09 -7.6970347e-08 -3.3983036e-07  3.9008773e-07 -7.0445763e-12 -1.2287442     -3.4541148e-11  9.216          9.216          9.216          782.7578     
        14   0             -472.768       -8.8850308e-09 -7.6948368e-08 -3.3983809e-07  3.9013136e-07  2.1588218e-11 -1.2287442      9.9987534e-12  9.216          9.216          9.216          782.7578     
        15   0             -472.768       -8.8074563e-09 -7.6856081e-08 -3.3982854e-07  3.9026225e-07 -7.4990651e-12 -1.2287442      6.6355364e-11  9.216          9.216          9.216          782.7578     
        16   0             -472.768       -8.8642834e-09 -7.6901124e-08 -3.3993944e-07  3.9024771e-07 -1.965664e-11  -1.2287442     -1.5452619e-11  9.216          9.216          9.216          782.7578     
        17   0             -472.768       -8.8695213e-09 -7.6914565e-08 -3.3989126e-07  3.9019726e-07  2.0451996e-12 -1.2287442     -3.1814216e-11  9.216          9.216          9.216          782.7578     
        18   0             -472.768       -8.8414034e-09 -7.6886341e-08 -3.3985308e-07  3.9021522e-07  3.306406e-11  -1.2287442     -5.9083543e-12  9.216          9.216          9.216          782.7578     
Loop time of 0.0368127 on 1 procs for 16 steps with 64 atoms

99.8% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
     -472.767999975874  -472.768000013643  -472.768000013643
  Force two-norm initial, final = 0.0010872364 9.3617917e-11
  Force max component initial, final = 0.00024560962 1.9398224e-11
  Final line search alpha, max atom move = 1 1.9398224e-11
  Iterations, force evaluations = 16 32

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.036357   | 0.036357   | 0.036357   |   0.0 | 98.76
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00011343 | 0.00011343 | 0.00011343 |   0.0 |  0.31
Output  | 0.00019923 | 0.00019923 | 0.00019923 |   0.0 |  0.54
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0001433  |            |       |  0.39

Nlocal:             64 ave          64 max          64 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:            665 ave         665 max         665 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           2560 ave        2560 max        2560 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:         5120 ave        5120 max        5120 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5120
Ave neighs/atom = 80
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -472.768000013643
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -8.84140341992844e-09
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -7.68863406568179e-08
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -3.39853084743675e-07
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 3.90215215140708e-07
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 3.30640596909509e-11
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -1.22874421107861
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -5.90835430903591e-12

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 7.63227745797048e-06
variable C2pos equal ${d2}
variable C2pos equal 3.39274974998975e-05
variable C3pos equal ${d3}
variable C3pos equal -3.908133223923e-05
variable C4pos equal ${d4}
variable C4pos equal 2.27244396501381e-10
variable C5pos equal ${d5}
variable C5pos equal 122.874421108587
variable C6pos equal ${d6}
variable C6pos equal -4.94189329628253e-09

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-7.63669688315518e-06+${C1pos})
variable C15 equal 0.5*(-7.63669688315518e-06+7.63227745797048e-06)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-3.39271339088631e-05+${C2pos})
variable C25 equal 0.5*(-3.39271339088631e-05+3.39274974998975e-05)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(3.90863088915134e-05+${C3pos})
variable C35 equal 0.5*(3.90863088915134e-05+-3.908133223923e-05)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(9.54426465305801e-10+${C4pos})
variable C45 equal 0.5*(9.54426465305801e-10+2.27244396501381e-10)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(122.874421103691+${C5pos})
variable C55 equal 0.5*(122.874421103691+122.874421108587)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(6.37353299424124e-09+${C6pos})
variable C65 equal 0.5*(6.37353299424124e-09+-4.94189329628253e-09)

# Delete dir to make sure it is not reused

variable dir delete

# uxy Perturbation

variable dir equal 6
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 9.2160000424006

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
Reading restart file ...
  restart file = 23 Jun 2022, LAMMPS = 23 Jun 2022
  restoring atom style atomic from restart
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  pair style meam stores no restart info
  64 atoms
  read_restart CPU = 0.000 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style	meam
pair_coeff * * library_ZrN.meam Zr N ZrN.meam Zr N
Reading MEAM library file library_ZrN.meam with DATE: 2015-02-12

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1e-06*${len0}
variable delta equal -1e-06*9.2160000424006
variable deltaxy equal -${up}*xy
variable deltaxy equal -1e-06*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -1e-06*xz
variable deltayz equal -${up}*yz
variable deltayz equal -1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -9.2160000424006e-06 remap units box
Changing box ...
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (-9.216e-06 0 0)

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 500 ${maxeval}
minimize 0 1e-10 500 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.26
  ghost atom cutoff = 6.26
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 9.913 | 9.913 | 9.913 Mbytes
   Step          Temp          PotEng         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
         2   0             -472.768        0.00013779616  0.00015680328  0.00012832998  0.00012825521  1.2287467      5.2887929e-07  4.2276193e-06  9.216          9.216          9.216          782.7578     
         3   0             -472.768        1.17276e-05    9.0509338e-06  9.8527126e-06  1.6279153e-05  1.2287454     -8.402724e-07  -8.4719438e-08  9.216          9.216          9.216          782.7578     
         4   0             -472.768        8.9128266e-07  8.8521597e-07  1.1400342e-06  6.4859778e-07  1.2287445     -5.247122e-07  -4.8996164e-08  9.216          9.216          9.216          782.7578     
         5   0             -472.768        1.963102e-07   6.9876887e-08  5.2975532e-07 -1.070162e-08   1.2287444      1.4723051e-08 -6.2033175e-09  9.216          9.216          9.216          782.7578     
         6   0             -472.768        1.1360521e-07  7.2618397e-08  5.1175438e-07 -2.4355714e-07  1.2287442      3.4775437e-08 -1.1848977e-08  9.216          9.216          9.216          782.7578     
         7   0             -472.768        1.258896e-08  -5.5023825e-08  4.1744341e-07 -3.2465271e-07  1.2287442      1.4325373e-08  1.175308e-09   9.216          9.216          9.216          782.7578     
         8   0             -472.768       -3.4921558e-09 -7.2742341e-08  3.9756998e-07 -3.3530411e-07  1.2287442      4.2050439e-09  8.8579866e-10  9.216          9.216          9.216          782.7578     
         9   0             -472.768       -6.4654317e-09 -7.5233197e-08  3.9334687e-07 -3.3750997e-07  1.2287442     -2.3928835e-10  1.4498192e-10  9.216          9.216          9.216          782.7578     
        10   0             -472.768       -8.3290698e-09 -7.6266725e-08  3.9064812e-07 -3.393686e-07   1.2287442     -1.3861908e-10 -8.7261848e-11  9.216          9.216          9.216          782.7578     
        11   0             -472.768       -8.7487075e-09 -7.6734146e-08  3.9022271e-07 -3.3973469e-07  1.2287442      0             -2.272444e-12   9.216          9.216          9.216          782.7578     
        12   0             -472.768       -8.7976402e-09 -7.6829587e-08  3.9026998e-07 -3.3983331e-07  1.2287442     -1.0566864e-11  4.5448879e-12  9.216          9.216          9.216          782.7578     
        13   0             -472.768       -8.8519393e-09 -7.6935446e-08  3.9019045e-07 -3.3981082e-07  1.2287442      0             -5.1357234e-11  9.216          9.216          9.216          782.7578     
        14   0             -472.768       -8.881076e-09  -7.6983998e-08  3.9015772e-07 -3.3981695e-07  1.2287442      2.1588218e-12 -2.3178928e-11  9.216          9.216          9.216          782.7578     
        15   0             -472.768       -8.8256025e-09 -7.6864162e-08  3.9023317e-07 -3.3984581e-07  1.2287442      8.5216649e-12 -2.9087283e-11  9.216          9.216          9.216          782.7578     
        16   0             -472.768       -8.9008691e-09 -7.6984975e-08  3.9018045e-07 -3.3989808e-07  1.2287442      8.4080427e-12  3.9540525e-11  9.216          9.216          9.216          782.7578     
        17   0             -472.768       -8.8929311e-09 -7.6979568e-08  3.9018954e-07 -3.3988876e-07  1.2287442      3.8631547e-12  7.2718207e-11  9.216          9.216          9.216          782.7578     
        18   0             -472.768       -8.982561e-09  -7.7064844e-08  3.9008728e-07 -3.3997012e-07  1.2287442     -2.9428149e-11 -2.8632794e-11  9.216          9.216          9.216          782.7578     
Loop time of 0.0338492 on 1 procs for 16 steps with 64 atoms

99.4% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
     -472.767999975874  -472.768000013644  -472.768000013644
  Force two-norm initial, final = 0.0010872365 9.3609111e-11
  Force max component initial, final = 0.00024560953 1.9174972e-11
  Final line search alpha, max atom move = 1 1.9174972e-11
  Iterations, force evaluations = 16 32

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.033532   | 0.033532   | 0.033532   |   0.0 | 99.06
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 7.621e-05  | 7.621e-05  | 7.621e-05  |   0.0 |  0.23
Output  | 0.00016516 | 0.00016516 | 0.00016516 |   0.0 |  0.49
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 7.609e-05  |            |       |  0.22

Nlocal:             64 ave          64 max          64 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:            665 ave         665 max         665 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           2560 ave        2560 max        2560 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:         5120 ave        5120 max        5120 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5120
Ave neighs/atom = 80
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -7.70648439337227e-08
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 3.90087276545478e-07
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -3.39970115607874e-07
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 1.2287442110585
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -2.94281493469288e-11
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -2.8632793959174e-11

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -7.65012778566096e-06
variable C2neg equal ${d2}
variable C2neg equal 3.90665386290177e-05
variable C3neg equal ${d3}
variable C3neg equal -3.39372008356282e-05
variable C4neg equal ${d4}
variable C4neg equal -2.49968836151519e-09
variable C5neg equal ${d5}
variable C5neg equal -3.66932467587479e-09
variable C6neg equal ${d6}
variable C6neg equal 122.874421107485

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
Reading restart file ...
  restart file = 23 Jun 2022, LAMMPS = 23 Jun 2022
  restoring atom style atomic from restart
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  pair style meam stores no restart info
  64 atoms
  read_restart CPU = 0.000 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style	meam
pair_coeff * * library_ZrN.meam Zr N ZrN.meam Zr N
Reading MEAM library file library_ZrN.meam with DATE: 2015-02-12

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		1
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1e-06*${len0}
variable delta equal 1e-06*9.2160000424006
variable deltaxy equal ${up}*xy
variable deltaxy equal 1e-06*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1e-06*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1e-06*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 9.2160000424006e-06 remap units box
Changing box ...
  triclinic box = (-4.608 -4.608 -4.608) to (4.608 4.608 4.608) with tilt (9.216e-06 0 0)

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 500 ${maxeval}
minimize 0 1e-10 500 1000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.26
  ghost atom cutoff = 6.26
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 9.913 | 9.913 | 9.913 Mbytes
   Step          Temp          PotEng         Press           Pxx            Pyy            Pzz            Pxy            Pxz            Pyz             Lx             Ly             Lz           Volume    
         2   0             -472.768        0.00013779618  0.0001568033   0.00012832998  0.00012825527 -1.2287417      5.2890486e-07  4.227582e-06   9.216          9.216          9.216          782.7578     
         3   0             -472.768        1.1727689e-05  9.0510075e-06  9.8528607e-06  1.62792e-05   -1.228743      -8.4031853e-07 -8.4789429e-08  9.216          9.216          9.216          782.7578     
         4   0             -472.768        8.9132792e-07  8.8524334e-07  1.1400329e-06  6.4870753e-07 -1.228744      -5.2467561e-07 -4.8985711e-08  9.216          9.216          9.216          782.7578     
         5   0             -472.768        1.9634154e-07  6.994094e-08   5.296926e-07  -1.0608905e-08 -1.2287441      1.4694986e-08 -6.1983182e-09  9.216          9.216          9.216          782.7578     
         6   0             -472.768        1.1362687e-07  7.2675631e-08  5.1178347e-07 -2.435785e-07  -1.2287442      3.4729193e-08 -1.1760352e-08  9.216          9.216          9.216          782.7578     
         7   0             -472.768        1.2519696e-08 -5.5095725e-08  4.1739524e-07 -3.2474042e-07 -1.2287442      1.4334236e-08  1.1039533e-09  9.216          9.216          9.216          782.7578     
         8   0             -472.768       -3.4448872e-09 -7.2693251e-08  3.9756271e-07 -3.3520412e-07 -1.2287442      4.2399259e-09  9.2806612e-10  9.216          9.216          9.216          782.7578     
         9   0             -472.768       -6.4196222e-09 -7.5132355e-08  3.933346e-07  -3.3746111e-07 -1.2287442     -2.7439761e-10  1.095318e-10   9.216          9.216          9.216          782.7578     
        10   0             -472.768       -8.1908735e-09 -7.6130965e-08  3.9084264e-07 -3.3928429e-07 -1.2287442     -6.771883e-11  -5.3175189e-11  9.216          9.216          9.216          782.7578     
        11   0             -472.768       -8.6697083e-09 -7.6703487e-08  3.9042314e-07 -3.3972878e-07 -1.2287442      2.9200905e-11 -6.3628431e-12  9.216          9.216          9.216          782.7578     
        12   0             -472.768       -8.8781412e-09 -7.6950423e-08  3.9015318e-07 -3.3983718e-07 -1.2287442      1.0566864e-11  4.2721947e-11  9.216          9.216          9.216          782.7578     
        13   0             -472.768       -8.8799873e-09 -7.6968914e-08  3.9016727e-07 -3.3983831e-07 -1.2287442     -2.533775e-11  -3.4995637e-11  9.216          9.216          9.216          782.7578     
        14   0             -472.768       -8.8523392e-09 -7.696846e-08   3.9019863e-07 -3.3978718e-07 -1.2287442     -4.5448879e-13  6.8173319e-12  9.216          9.216          9.216          782.7578     
        15   0             -472.768       -8.8916185e-09 -7.7044712e-08  3.9015636e-07 -3.397865e-07  -1.2287442     -1.4657264e-11  2.272444e-11   9.216          9.216          9.216          782.7578     
        16   0             -472.768       -8.7883947e-09 -7.6850254e-08  3.9031361e-07 -3.3982854e-07 -1.2287442     -2.840555e-11  -1.6361597e-11  9.216          9.216          9.216          782.7578     
        17   0             -472.768       -8.9099177e-09 -7.7006212e-08  3.9018317e-07 -3.3990671e-07 -1.2287442      1.3407419e-11 -9.0897759e-13  9.216          9.216          9.216          782.7578     
        18   0             -472.768       -8.8313367e-09 -7.6904544e-08  3.9023408e-07 -3.3982354e-07 -1.2287442     -7.0445763e-11  5.4993144e-11  9.216          9.216          9.216          782.7578     
Loop time of 0.0328945 on 1 procs for 16 steps with 64 atoms

99.9% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
     -472.767999975874  -472.768000013644  -472.768000013643
  Force two-norm initial, final = 0.0010872364 9.358725e-11
  Force max component initial, final = 0.00024560958 1.9446633e-11
  Final line search alpha, max atom move = 1 1.9446633e-11
  Iterations, force evaluations = 16 32

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.032636   | 0.032636   | 0.032636   |   0.0 | 99.21
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 7.4026e-05 | 7.4026e-05 | 7.4026e-05 |   0.0 |  0.23
Output  | 0.00011084 | 0.00011084 | 0.00011084 |   0.0 |  0.34
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 7.339e-05  |            |       |  0.22

Nlocal:             64 ave          64 max          64 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:            665 ave         665 max         665 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           2560 ave        2560 max        2560 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:         5120 ave        5120 max        5120 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5120
Ave neighs/atom = 80
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -472.768000013643
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -8.83133668751537e-09
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -7.69045435160335e-08
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 3.90234076425618e-07
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -3.3982354297213e-07
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -1.22874421103043
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -7.04457629154281e-11
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 5.49931439533342e-11

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 7.63409774389204e-06
variable C2pos equal ${d2}
variable C2pos equal -3.90812186170317e-05
variable C3pos equal ${d3}
variable C3pos equal 3.39225435720538e-05
variable C4pos equal ${d4}
variable C4pos equal -5.86290542973563e-09
variable C5pos equal ${d5}
variable C5pos equal 7.77108603272472e-09
variable C6pos equal ${d6}
variable C6pos equal 122.874421101408

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-7.65012778566096e-06+${C1pos})
variable C16 equal 0.5*(-7.65012778566096e-06+7.63409774389204e-06)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(3.90665386290177e-05+${C2pos})
variable C26 equal 0.5*(3.90665386290177e-05+-3.90812186170317e-05)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-3.39372008356282e-05+${C3pos})
variable C36 equal 0.5*(-3.39372008356282e-05+3.39225435720538e-05)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-2.49968836151519e-09+${C4pos})
variable C46 equal 0.5*(-2.49968836151519e-09+-5.86290542973563e-09)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-3.66932467587479e-09+${C5pos})
variable C56 equal 0.5*(-3.66932467587479e-09+7.77108603272472e-09)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(122.874421107485+${C6pos})
variable C66 equal 0.5*(122.874421107485+122.874421101408)

# Delete dir to make sure it is not reused

variable dir delete

# Output final values

variable C11all equal ${C11}
variable C11all equal 480.693410105252
variable C22all equal ${C22}
variable C22all equal 480.693410101718
variable C33all equal ${C33}
variable C33all equal 480.693410099219

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(82.6256080917979+${C21})
variable C12all equal 0.5*(82.6256080917979+82.6256080877775)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(82.6256080951935+${C31})
variable C13all equal 0.5*(82.6256080951935+82.6256080818464)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(82.6256080985943+${C32})
variable C23all equal 0.5*(82.6256080985943+82.6256080913566)

variable C44all equal ${C44}
variable C44all equal 122.874421106077
variable C55all equal ${C55}
variable C55all equal 122.874421106139
variable C66all equal ${C66}
variable C66all equal 122.874421104446

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-4.06556928604941e-09+${C41})
variable C14all equal 0.5*(-4.06556928604941e-09+-1.81795844433217e-09)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-2.20971259234987e-09+${C51})
variable C15all equal 0.5*(-2.20971259234987e-09+-3.39730396630566e-09)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-8.0150208844604e-09+${C61})
variable C16all equal 0.5*(-8.0150208844604e-09+4.43127152651345e-10)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(1.72705741341023e-09+${C42})
variable C24all equal 0.5*(1.72705741341023e-09+-2.11337086498983e-09)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(1.81795517201433e-10+${C52})
variable C25all equal 0.5*(1.81795517201433e-10+-3.28936230417529e-09)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-7.33999400699982e-09+${C62})
variable C26all equal 0.5*(-7.33999400699982e-09+-1.61343490838149e-09)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(2.29516840464904e-09+${C43})
variable C34all equal 0.5*(2.29516840464904e-09+-3.6359389768197e-10)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(2.48832614170076e-09+${C53})
variable C35all equal 0.5*(2.48832614170076e-09+-6.76050664995918e-10)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-7.32863178720035e-09+${C63})
variable C36all equal 0.5*(-7.32863178720035e-09+5.851537244751e-10)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(5.90835430903591e-10+${C54})
variable C45all equal 0.5*(5.90835430903591e-10+-2.03951845859989e-09)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-4.18129689562541e-09+${C64})
variable C46all equal 0.5*(-4.18129689562541e-09+9.71469795043404e-10)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(2.05088067842497e-09+${C65})
variable C56all equal 0.5*(2.05088067842497e-09+7.15819848979355e-10)

# Average moduli for cubic crystals

variable C11cubic equal (${C11all}+${C22all}+${C33all})/3.0
variable C11cubic equal (480.693410105252+${C22all}+${C33all})/3.0
variable C11cubic equal (480.693410105252+480.693410101718+${C33all})/3.0
variable C11cubic equal (480.693410105252+480.693410101718+480.693410099219)/3.0
variable C12cubic equal (${C12all}+${C13all}+${C23all})/3.0
variable C12cubic equal (82.6256080897877+${C13all}+${C23all})/3.0
variable C12cubic equal (82.6256080897877+82.62560808852+${C23all})/3.0
variable C12cubic equal (82.6256080897877+82.62560808852+82.6256080949754)/3.0
variable C44cubic equal (${C44all}+${C55all}+${C66all})/3.0
variable C44cubic equal (122.874421106077+${C55all}+${C66all})/3.0
variable C44cubic equal (122.874421106077+122.874421106139+${C66all})/3.0
variable C44cubic equal (122.874421106077+122.874421106139+122.874421104446)/3.0

variable bulkmodulus equal (${C11cubic}+2*${C12cubic})/3.0
variable bulkmodulus equal (480.693410102063+2*${C12cubic})/3.0
variable bulkmodulus equal (480.693410102063+2*82.6256080910944)/3.0
variable shearmodulus1 equal ${C44cubic}
variable shearmodulus1 equal 122.874421105554
variable shearmodulus2 equal (${C11cubic}-${C12cubic})/2.0
variable shearmodulus2 equal (480.693410102063-${C12cubic})/2.0
variable shearmodulus2 equal (480.693410102063-82.6256080910944)/2.0
variable poissonratio equal 1.0/(1.0+${C11cubic}/${C12cubic})
variable poissonratio equal 1.0/(1.0+480.693410102063/${C12cubic})
variable poissonratio equal 1.0/(1.0+480.693410102063/82.6256080910944)

# For Stillinger-Weber silicon, the analytical results
# are known to be (E. R. Cowley, 1988):
#               C11 = 151.4 GPa
#               C12 = 76.4 GPa
#               C44 = 56.4 GPa

print "========================================="
=========================================
print "Components of the Elastic Constant Tensor"
Components of the Elastic Constant Tensor
print "========================================="
=========================================

print "Elastic Constant C11all = ${C11all} ${cunits}"
Elastic Constant C11all = 480.693410105252 GPa
print "Elastic Constant C22all = ${C22all} ${cunits}"
Elastic Constant C22all = 480.693410101718 GPa
print "Elastic Constant C33all = ${C33all} ${cunits}"
Elastic Constant C33all = 480.693410099219 GPa

print "Elastic Constant C12all = ${C12all} ${cunits}"
Elastic Constant C12all = 82.6256080897877 GPa
print "Elastic Constant C13all = ${C13all} ${cunits}"
Elastic Constant C13all = 82.62560808852 GPa
print "Elastic Constant C23all = ${C23all} ${cunits}"
Elastic Constant C23all = 82.6256080949754 GPa

print "Elastic Constant C44all = ${C44all} ${cunits}"
Elastic Constant C44all = 122.874421106077 GPa
print "Elastic Constant C55all = ${C55all} ${cunits}"
Elastic Constant C55all = 122.874421106139 GPa
print "Elastic Constant C66all = ${C66all} ${cunits}"
Elastic Constant C66all = 122.874421104446 GPa

print "Elastic Constant C14all = ${C14all} ${cunits}"
Elastic Constant C14all = -2.94176386519079e-09 GPa
print "Elastic Constant C15all = ${C15all} ${cunits}"
Elastic Constant C15all = -2.80350827932776e-09 GPa
print "Elastic Constant C16all = ${C16all} ${cunits}"
Elastic Constant C16all = -3.78594686590453e-09 GPa

print "Elastic Constant C24all = ${C24all} ${cunits}"
Elastic Constant C24all = -1.931567257898e-10 GPa
print "Elastic Constant C25all = ${C25all} ${cunits}"
Elastic Constant C25all = -1.55378339348693e-09 GPa
print "Elastic Constant C26all = ${C26all} ${cunits}"
Elastic Constant C26all = -4.47671445769066e-09 GPa

print "Elastic Constant C34all = ${C34all} ${cunits}"
Elastic Constant C34all = 9.65787253483535e-10 GPa
print "Elastic Constant C35all = ${C35all} ${cunits}"
Elastic Constant C35all = 9.06137738352421e-10 GPa
print "Elastic Constant C36all = ${C36all} ${cunits}"
Elastic Constant C36all = -3.37173903136263e-09 GPa

print "Elastic Constant C45all = ${C45all} ${cunits}"
Elastic Constant C45all = -7.24341513848149e-10 GPa
print "Elastic Constant C46all = ${C46all} ${cunits}"
Elastic Constant C46all = -1.604913550291e-09 GPa
print "Elastic Constant C56all = ${C56all} ${cunits}"
Elastic Constant C56all = 1.38335026370216e-09 GPa

print "========================================="
=========================================
print "Average properties for a cubic crystal"
Average properties for a cubic crystal
print "========================================="
=========================================

print "Bulk Modulus = ${bulkmodulus} ${cunits}"
Bulk Modulus = 215.314875428084 GPa
print "Shear Modulus 1 = ${shearmodulus1} ${cunits}"
Shear Modulus 1 = 122.874421105554 GPa
print "Shear Modulus 2 = ${shearmodulus2} ${cunits}"
Shear Modulus 2 = 199.033901005484 GPa
print "Poisson Ratio = ${poissonratio}"
Poisson Ratio = 0.146676404350976
variable length equal "lx"
print "Lattice constant (Angstroms) = ${length};"
Lattice constant (Angstroms) = 9.2160000424006;
Total wall time: 0:00:00
